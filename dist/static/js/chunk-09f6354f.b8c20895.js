(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-09f6354f"],{3566:function(t,e,a){"use strict";a("470e")},"470e":function(t,e,a){},bbd4:function(t,e,a){"use strict";a.r(e);a("99af"),a("7db0"),a("4160"),a("c975"),a("a15b"),a("d81d"),a("a9e3"),a("d3b7"),a("820e"),a("3ca3"),a("159b"),a("ddb0");var s={name:"PursesTransfer",mixins:[a("c28f").a],data:function(){return{checked:!0,transfer:!1,money:1,platforms:[],balance:{},columns:[],gameBalance:0,showPicker:!1,platformName:"",platformCode:"",refreshIcon:!1}},created:function(){this.onGetOpenPlatforms()},activated:function(){this.initMemberData(),this.money=0},methods:{onLoad:function(){var t=this;if(!this.isVirtualMember()&&!this.isDottedMember()){var e=this.platforms;this.gameBalance=0,this.showProgress();var a=function(a){t.$get("/api/Game/RefreshBalance?platformCode="+e[a].platformCode).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(s){var n=s.data;t.balance[e[a].platformCode]=n,Number(n)>0&&(t.gameBalance=t.formatNum(t.gameBalance+n,2)),Number(a)===Number(e.length-1)&&setTimeout((function(){t.showProgress(!1)}),1e3)})).catch((function(e){t.showProgress(!1),t.procError(e)}))};for(var s in e)a(s)}},refreshBalance:function(){var t=this;this.refreshIcon=!this.refreshIcon,setTimeout((function(){t.refreshIcon=!t.refreshIcon}),1e3),this.initMemberData(),this.onLoad()},onGetOpenPlatforms:function(){var t=this;this.$get("/api/Game/GetOpenPlatforms").then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var a=e.data;t.platforms=a,t.columns=a,t.platformName=a[0]?a[0].platformName:"",t.platformCode=a[0]?a[0].platformCode:"",t.onLoad()})).catch((function(e){t.procError(e)}))},onTransformAll:function(){var t=this;if(!this.isVirtualMember()&&!this.isDottedMember()){this.showProgress(!0,1e4);var e=this.platforms;this.gameBalance=0,this.errorMsg=[];var a=e.map((function(e){return t.$get("/api/Game/TransformByPlatformCode?type=1&money=0&platformCode=".concat(e.platformCode))}));Promise.allSettled(a).then((function(a){a.forEach((function(a){if("fulfilled"===a.status){var s=a.value.config.url,n=s.substring(s.indexOf("platformCode=")+13),r=Number(a.value.data.data);isNaN(r)&&(r=0),t.balance[n]=r,t.gameBalance=t.formatNum(t.gameBalance+r,2)}else{var o=a.reason.config.url,i=o.substring(o.indexOf("platformCode=")+13);t.errorMsg.push(e.find((function(t){return t.platformCode===i})).platformName)}})),t.showProgress(!1),t.errorMsg.length?setTimeout((function(){return t.$dialog.confirm({title:t.$t("purses._1"),message:t.errorMsg.join()+", "+t.$t("purses._2")}).then((function(){})).catch((function(){}))}),0):setTimeout((function(){return t.$success(t.$t("common.transformSuccess"))}),0),t.initMemberData()}))}},onTransformByPlatformCode:function(){var t=this;this.money<=0?this.$toast(this.$$t("moneyT")):this.$dialog.confirm({title:this.$t("common.point"),message:this.$$t("pointInfo")}).then((function(){t.showProgress(),t.$get("/api/Game/TransformByPlatformCode?type=".concat(t.transfer?1:0,"&money=").concat(t.money,"&platformCode=").concat(t.platformCode)).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(){return t.$get("/api/Game/RefreshBalance?platformCode="+t.platformCode)})).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var a=e.data;t.gameBalance=t.gameBalance-t.balance[t.platformCode],t.balance[t.platformCode]=a,Number(a)>0&&(t.gameBalance=t.formatNum(t.gameBalance+a,2)),t.initMemberData(),t.money=1,t.showProgress(!1),t.$success(t.$$t("success"))})).catch((function(e){t.showProgress(!1),t.procError(e)}))})).catch((function(){}))},changeTransfer:function(){this.transfer=!this.transfer,this.money=0},moneyAllClick:function(){this.transfer?this.money=this.balance[this.platformCode]:this.money=this.memberData.balance},onConfirm:function(t){this.platformName=t.platformName,this.platformCode=t.platformCode,this.showPicker=!1},$$t:function(t){return this.$t("pursesTransfer."+t)}}},n=(a("3566"),a("2877")),r=Object(n.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"pursesTransfer"}},[a("div",{staticClass:"warp-center"},[a("scroller",[a("div",{staticClass:"warp py-6 text-left"},[a("div",{staticClass:"background-white"},[a("van-cell",{attrs:{size:"large",center:"",border:""},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"flex align-items-center"},[a("span",{staticClass:"custom-title mr-1"},[t._v(t._s(t.$$t("amount")))]),a("van-icon",{class:{refresh:t.refreshIcon},attrs:{name:"/images/member/purses/refresh.png",size:"18"},on:{click:t.refreshBalance}})],1)]},proxy:!0},{key:"default",fn:function(){return[a("div",{on:{click:t.onTransformAll}},[t._v(t._s(t.$$t("recycle")))])]},proxy:!0}])}),a("van-row",{staticClass:"mt-5 purse-details",attrs:{type:"flex",justify:"center"}},[a("van-col",{attrs:{span:"12"}},[a("div",{staticClass:"text-center"},[a("div",{staticClass:"flex justify-content-center align-items-center"},[a("van-image",{attrs:{src:"/images/member/purses/purse.png",width:"16",height:"14"}}),a("div",{staticClass:"caption text-grey ml-1"},[t._v(t._s(t.$$t("centralWallet")))])],1),a("div",{staticClass:"subtitle-4 main-text mt-1"},[t._v(t._s(t.currencySymbol)+t._s(t.memberData&&t.memberData.balance)+t._s(t.currencyDenomination)+" ")])])]),a("van-col",{attrs:{span:"12"}},[a("div",{staticClass:"text-center"},[a("div",{staticClass:"flex justify-content-center align-items-center"},[a("van-image",{attrs:{src:"/images/member/purses/purse.png",width:"16",height:"14"}}),a("div",{staticClass:"caption text-grey ml-1"},[t._v(t._s(t.$$t("gameWallet")))])],1),a("div",{staticClass:"subtitle-4 main-text mt-1"},[t._v(" "+t._s(t.gameBalance>0?t.currencySymbol+t.gameBalance+t.currencyDenomination:"——")+" ")])])])],1),a("div",{staticClass:"change mt-4 flex justify-content-center align-items-center"},[a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"subtitle-1 mr-1"},[t._v(t._s(t.$$t("centralWallet")))]),a("van-icon",{attrs:{name:"arrow",color:"lightslategray",size:"14"}})],1),a("van-image",{staticClass:"mx-11",attrs:{src:"/images/member/purses/"+(t.transfer?"change_f":"change")+".png",width:"20",height:"15"},on:{click:t.changeTransfer}}),a("div",{staticClass:"flex align-items-center",on:{click:function(e){t.showPicker=!0}}},[a("div",{staticClass:"subtitle-1 mr-1"},[t._v(t._s(t.platformName))]),a("van-icon",{attrs:{name:"arrow",color:"lightslategray",size:"14"}})],1)],1),a("van-divider",{staticClass:"ma-0 pa-0"}),a("div",{staticClass:"money py-2 px-4 background-white"},[a("div",{staticClass:"caption text-grey"},[t._v(t._s(t.$$t("walletDesc")))]),a("van-field",{staticClass:"px-2 mb-1 mt-2",attrs:{type:"digit",center:"",clearable:"",placeholder:t.$$t("moneyDesc"),"input-align":"left"},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{attrs:{size:"small"},on:{click:t.moneyAllClick}},[t._v(t._s(t.$$t("moneyAll")))])]},proxy:!0}]),model:{value:t.money,callback:function(e){t.money=e},expression:"money"}},[a("span",{staticClass:"body-1",attrs:{slot:"left-icon"},slot:"left-icon"},[t._v(t._s(t.currencySymbol))]),t.currencyDenomination?a("div",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v(t._s(t.currencyDenomination))]):t._e()]),Number(t.money)>Number(t.memberData&&t.memberData.balance)&&!1===t.transfer?a("div",{staticClass:"money_desc py-2 pl-3"},[t._v(" "+t._s(t.$$t("balanceDesc"))+" ")]):t._e()],1),a("van-divider",{staticClass:"mt-2"}),a("van-row",{staticClass:"px-4",attrs:{type:"flex",align:"center"}},[t._l(t.platforms,(function(e,s){return[a("van-col",{key:s,class:{purse:s%4},attrs:{span:"6"}},[a("div",{staticClass:"text-center py-3 px-2"},[a("div",{staticClass:"caption"},[t._v(t._s(e.platformName))]),a("div",{staticClass:"caption text-grey mt-1"},[t._v(t._s(t.currencySymbol)+t._s(t.balance&&t.balance[e.platformCode]||0)+t._s(t.currencyDenomination)+" ")])])])]}))],2)],1)])])],1),a("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[a("van-picker",{attrs:{"show-toolbar":"",title:t.$$t("picker"),"value-key":"platformName",columns:t.columns},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1),a("van-tabbar",{staticClass:"py-2",attrs:{fixed:""}},[a("div",{staticClass:"btn px-4"},[a("van-button",{staticClass:"radius-2",attrs:{hairline:"",block:"",color:"linear-gradient(to right, rgb(154, 187, 255), rgb(70, 132, 255))"},on:{click:t.onTransformByPlatformCode}},[t._v(" "+t._s(t.$$t("submit"))+" ")])],1)])],1)}),[],!1,null,"478d9d20",null);e.default=r.exports}}]);