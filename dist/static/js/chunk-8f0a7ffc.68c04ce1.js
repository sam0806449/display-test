(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8f0a7ffc"],{"5a3c":function(t,s,i){},bc65:function(t,s,i){"use strict";i("5a3c")},e4d8:function(t,s,i){"use strict";i.r(s);i("4160"),i("b0c0"),i("d3b7"),i("25f0"),i("159b");var a={name:"TaskSubmit",data:function(){return{platformAccount:null,task:null,fileList:[],uploadImages:[]}},activated:function(){this.task=JSON.parse(sessionStorage.getItem("Note-data"))},methods:{afterRead:function(t){t.status="uploading",t.message=this.$$t("uploading"),setTimeout((function(){t.status=null,t.message=null}),1e3)},uploadImage:function(){var t=this;this.fileList.length<1?this.$toast(this.$$t("upload")+this.$t("common.noNull")):this.fileList.forEach((function(s){t.imgPreview(s.file)}))},onSubmitTask:function(){var t=this;this.platformAccount?(this.showProgress(!0),this.$post("/api/Task/SubmitCheck?objId="+(this.task&&this.task.category_task_applyId)+"&platformAccount="+this.platformAccount+"&fileNames="+this.uploadImages.toString()).then((function(s){return t.checkResp(s,(function(t){return!0===t.data.success}))})).then((function(s){t.$toast(s.data),t.$router.push("/app/taskNotes"),t.$success(t.$t("common.submitSuccess"))})).catch((function(s){t.showProgress(!1),t.procError(s)}))):this.$toast(this.$$t("platformAccount")+this.$t("common.noNull"))},onSubmit:function(){var t=this;this.$dialog.confirm({title:this.$t("common.point"),message:this.$$t("isSubmit")}).then((function(){t.uploadImage()})).catch((function(){}))},imgPreview:function(t){var s=this,i={name:t.name,type:t.type};if(/^image/.test(t.type)){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){var t=this.result,a=new Image;a.src=t,this.result.length<=512e3?s.postImg(this.result,i):a.onload=function(){var t=s.compress(a,void 0);s.postImg(t,i)}}}},postImg:function(t,s){var i=this,a=this.dataURLtoFile(t,s),e=new FormData;e.append("file",a),e.append("owner",this.siteConfig.codeKey||"default"),this.$post((this.siteConfig&&this.siteConfig.imgPath)+"/upload?",e).then((function(t){return i.checkResp(t,(function(t){return 1===t.data.code}))})).then((function(t){i.uploadImages.push(t.fileUrl),i.fileList.length===i.uploadImages.length&&i.onSubmitTask()})).catch((function(t){i.procError(t)}))},onOversize:function(){this.$toast(this.$t("common.imgSizeDesc"))},$$t:function(t){return this.$t("taskSubmit."+t)}}},e=(i("bc65"),i("2877")),n=Object(e.a)(a,(function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"taskSubmit"}},[i("scroller",[i("div",{staticClass:"taskSubmit-wap"},[i("div",{staticClass:"center"},[i("div",{staticClass:"left"},[i("van-image",{attrs:{width:"46",height:"46",src:t.$portrait(t.task&&t.task.categoryIco)}})],1),i("div",{staticClass:"right"},[i("div",[i("div",{staticClass:"title"},[t._v(t._s(t.task&&t.task.title))]),i("div",{staticClass:"desc"},[t._v(t._s(t.$$t("price"))+"ï¼š"+t._s(t.currencySymbol)+t._s(t.task&&t.task.price)+t._s(t.currencyDenomination))])]),i("div",{staticClass:"right-r"},[i("van-icon",{attrs:{name:"images/task/link.png",size:"16"}})],1)])]),i("div",{staticClass:"verify"},[i("div",{staticClass:"title"},[t._v(t._s(t.$$t("uploadText"))+" "),i("span",[t._v(t._s(t.$$t("total")))])]),i("div",{staticClass:"update-img"},[i("div",{staticClass:"title"},[t._v("1."+t._s(t.$$t("upload")))]),i("van-uploader",{attrs:{multiple:"","max-size":2097152,"after-read":t.afterRead,"max-count":3},on:{oversize:t.onOversize},model:{value:t.fileList,callback:function(s){t.fileList=s},expression:"fileList"}})],1),i("div",{staticClass:"verify-wx"},[i("div",{staticClass:"title"},[t._v("2."+t._s(t.$$t("weChatNickname")))]),i("van-field",{attrs:{placeholder:t.$$t("wNameP")},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.onSubmit(s)}},model:{value:t.platformAccount,callback:function(s){t.platformAccount=s},expression:"platformAccount"}})],1)])])]),i("van-tabbar",{attrs:{fixed:""}},[i("van-button",{attrs:{hairline:"",block:"",color:"linear-gradient(to right, rgb(154, 187, 255), rgb(70, 132, 255))"},on:{click:t.onSubmit}},[t._v(" "+t._s(t.$$t("submit"))+" ")])],1)],1)}),[],!1,null,"6fb9caa2",null);s.default=n.exports}}]);