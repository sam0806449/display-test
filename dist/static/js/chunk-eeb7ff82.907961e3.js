(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-eeb7ff82"],{"0fe9":function(t,e,a){},aa27:function(t,e,a){"use strict";a("0fe9")},d300:function(t,e,a){"use strict";a.r(e);a("4160"),a("d81d"),a("a9e3"),a("b680"),a("159b");var s=a("2909"),n=a("28a2"),r={name:"SubordinateAgent",data:function(){return{active:"agent",radio:"1",pageIndex:1,membershipLevel:1,stepperNumber:0,platformCommisonRate:0,defaultSets:[],intrs:[],showCalculate:!1,createDisabled:!1,odds:0,rebate:0,showSheet:!1,intrIrtem:null,showCommissions:!1,commissions:[],groupItems:[],activeNames:[],showRemark:!1,remark:""}},created:function(){this.onDefaultMemberIntr()},computed:{lowerOdds:function(){var t=Number(this.odds)-Number(this.odds)*Number(this.rebate)/98;return 0===t?0:t.toFixed(4)},actions:function(){return[{name:this.$$t("a_1"),code:"1"},{name:this.$$t("a_2"),code:"2"},{name:this.$$t("a_3"),code:"3"},{name:this.$$t("a_4"),code:"4"},{name:this.$$t("a_5"),code:"5"}]}},watch:{active:function(t){"intr"===t?this.onGetMemberIntrPage():this.onDefaultMemberIntr(),this.stepperNumber=0}},methods:{onGetGroup:function(){var t=this;this.showProgress(),this.$get("/api/Lottery/GetGroup").then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var a=e.data;t.defaultSets.forEach((function(t){a.forEach((function(e){e.lotteries.forEach((function(e){e.type===t.gamePlatformCode&&(e.maxRebate=t.maxRebate,e.rebate=t.rebate)}))}))})),t.groupItems=a,t.activeNames=[a[0].type],t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},onCreateMemberIntr:function(){var t=this;this.createDisabled=!0;var e=[];this.groupItems.forEach((function(t){e.push.apply(e,Object(s.a)(t.lotteries))}));var a=e.map((function(t){return{gamePlatformCode:t.type,rebate:Number(t.rebate)}}));this.showProgress(),this.$post("/api/MemberAgent/CreateMemberIntr",a).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(){t.createDisabled=!1,t.active="intr",t.showProgress(!1)})).catch((function(e){t.createDisabled=!1,t.showProgress(!1),t.procError(e)}))},onDefaultMemberIntr:function(){var t=this;this.showProgress(),this.$post("/api/MemberAgent/GetDefaultMemberIntrCommission").then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var a=e.data;t.defaultSets=a,t.platformCommisonRate=t.getMaxRebate(a),t.onGetGroup(),t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},onGetMemberIntrPage:function(){var t=this;this.showProgress(),this.$post("/api/MemberAgent/GetMemberIntrPage",{pageIndex:this.pageIndex,pageSize:10}).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var a=e.data;t.intrs=a.items,t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},onGetIntrCommission:function(){var t=this;this.showProgress(),this.$post("/api/MemberAgent/GetMemberIntrCommission?intrId=".concat(this.intrIrtem.intrId)).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){t.commissions=e.data,t.showCommissions=!0,t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},onLoadRemark:function(){var t=this;this.showProgress(),this.$post("/api/MemberAgent/GetMemberIntrIRemark?intrId=".concat(this.intrIrtem.intrId)).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){t.remark=e.data,t.showRemark=!0,t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},onSaveRemark:function(){var t=this;this.showProgress(),this.$post("/api/MemberAgent/SaveMemberIntrIRemark",{intrId:this.intrIrtem.intrId,remark:this.remark}).then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){t.showRemark=!1,t.$info(e.data),t.showProgress(!1)})).catch((function(e){t.showProgress(!1),t.procError(e)}))},getScope:function(t,e){return Number(e)>Number(t)?0:(Number(t)-Number(e)).toFixed(1)},onChangeRate:function(t){Number(t)<=Number(this.platformCommisonRate)&&(this.stepperNumber=t),this.groupItems.forEach((function(e){e.lotteries.forEach((function(e){Number(t)<=Number(e.maxRebate)?e.rebate=Number(t):e.rebate=Number(e.maxRebate)}))}))},onShowSheet:function(t){this.intrIrtem=t,this.showSheet=!0},onSelectSheet:function(t){this.intrIrtem&&("1"===t.code?this.copyBtnClick(this.intrIrtem.intrId):"2"===t.code?this.copyBtnClick(this.intrIrtem.fullIntrUrl):"3"===t.code?Object(n.a)({images:["/api/MemberAgent/GetMemberIntrImage?intrId=".concat(this.intrIrtem.intrId)],closeable:!0}):"4"===t.code?this.onGetIntrCommission():"5"===t.code&&this.onLoadRemark())},onCancelSheet:function(){this.intrIrtem=null},getMaxRebate:function(t){var e=t.map((function(t){return t.maxRebate}));return Math.max.apply(Math,Object(s.a)(e))},getImage:function(t){return this.siteConfig&&this.siteConfig.imgPath+"/common/img/slots/SGLottery/"+t},$$t:function(t,e){return this.$t("subordinateAgent."+t,e)}}},o=(a("aa27"),a("2877")),i=Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"subordinateAgent"}},[a("van-tabs",{attrs:{animated:"",swipeable:"","title-active-color":"rgb(64, 128, 255)","title-inactive-color":"rgb(153, 153, 153)",color:"rgb(64, 128, 255)"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tab",{attrs:{title:t.$$t("tab_1"),name:"agent"}},[a("div",{staticClass:"agent-warps"},[a("scroll-view",[a("div",{staticClass:"text-grey_1 text-left body-2 px-3 py-1 mt-3 flex space-between align-items-center"},[a("div",[t._v(t._s(t.$$t("set")))]),a("div",{staticClass:"main-text",on:{click:function(e){t.showCalculate=!0}}},[t._v(t._s(t.$$t("calculate")))])]),a("div",{staticClass:"text-left"},[a("van-cell",{attrs:{title:t.$$t("batch"),label:t.$$t("batchLabel",{stepperNumber:t.stepperNumber,scope:t.getScope(t.platformCommisonRate,t.stepperNumber)}),center:""}},[a("van-stepper",{attrs:{min:"0",max:t.platformCommisonRate,step:"0.1","decimal-length":1,"async-change":""},on:{change:t.onChangeRate},model:{value:t.stepperNumber,callback:function(e){t.stepperNumber=e},expression:"stepperNumber"}})],1)],1),a("div",{staticClass:"text-left mt-3"},[a("van-collapse",{attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.groupItems,(function(e){return a("van-collapse-item",{key:e.type,attrs:{name:e.type},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"flex align-items-center"},[a("van-icon",{staticClass:"mr-1",attrs:{name:t.getImage(e.icon),size:"18"}}),a("div",{staticClass:"subtitle-1"},[t._v(t._s(e.name))])],1)]},proxy:!0}],null,!0)},t._l(e.lotteries,(function(e,s){return a("van-cell",{key:s,attrs:{title:e.name,label:t.$$t("batchLabel",{stepperNumber:e.rebate,scope:t.getScope(e.maxRebate,e.rebate)})}},[a("van-stepper",{attrs:{min:"0",max:e.maxRebate,step:"0.1","decimal-length":1},model:{value:e.rebate,callback:function(a){t.$set(e,"rebate",a)},expression:"item.rebate"}})],1)})),1)})),1)],1)])],1)]),a("van-tab",{attrs:{title:t.$$t("tab_2"),name:"intr"}},[a("div",{staticClass:"background-white py-2 text-grey_1"},[a("van-row",{attrs:{type:"flex",justify:"space-between"}},[a("van-col",{attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("invitationCode")))])]),a("van-col",{attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("regNumber")))])]),a("van-col",{attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("creationTime")))])])],1)],1),a("div",{staticClass:"intr-warps"},[a("scroll-view",[t.intrs.length>0?a("div",t._l(t.intrs,(function(e,s){return a("van-row",{key:s,staticClass:"background-white py-3 hairline_bottom",attrs:{type:"flex",justify:"space-between"},on:{click:function(a){return t.onShowSheet(e)}}},[a("van-col",{attrs:{span:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v(t._s(e.intrId))])]),a("van-col",{attrs:{span:"6"}},[a("span",{staticClass:"subtitle-1"},[t._v(t._s(e.memberAmount))])]),a("van-col",{attrs:{span:"10"}},[a("span",{staticClass:"subtitle-1"},[t._v(t._s(e.createTime))])])],1)})),1):a("van-empty",{staticClass:"text-center",attrs:{description:t.$t("common.noMore")},scopedSlots:t._u([{key:"image",fn:function(){return[a("van-image",{attrs:{src:"/images/empty/no-more.png",width:"280",height:"130"}})]},proxy:!0}])})],1)],1)])],1),"agent"===t.active?a("div",{staticClass:"nvaBtn px-4 py-2 background-white"},[a("van-button",{staticClass:"radius-2",attrs:{color:"linear-gradient(to right, rgb(117, 162, 255), rgb(70, 132, 255))",block:"",disabled:t.createDisabled},on:{click:t.onCreateMemberIntr}},[t._v(" "+t._s(t.$$t("createdCode"))+" ")])],1):t._e(),a("van-dialog",{attrs:{title:t.$$t("calculate"),confirmButtonColor:"rgb(117, 162, 255)"},model:{value:t.showCalculate,callback:function(e){t.showCalculate=e},expression:"showCalculate"}},[a("div",{staticClass:"text-left calculate px-4 pb-2 mt-3"},[a("div",{staticClass:"body-2 mb-1"},[t._v(t._s(t.$$t("odds")))]),a("van-field",{attrs:{type:"number"},model:{value:t.odds,callback:function(e){t.odds=e},expression:"odds"}}),a("div",{staticClass:"body-2 mt-2 mb-1"},[t._v(t._s(t.$$t("rebate")))]),a("van-field",{attrs:{type:"number"},model:{value:t.rebate,callback:function(e){t.rebate=e},expression:"rebate"}}),a("div",{staticClass:"body-2 mt-2 mb-1"},[t._v(t._s(t.$$t("lowerOdds")))]),a("van-field",{attrs:{value:t.lowerOdds,type:"number",readonly:""}})],1)]),a("van-action-sheet",{attrs:{actions:t.actions,"cancel-text":t.$$t("cancel"),"close-on-click-action":""},on:{select:t.onSelectSheet,cancel:t.onCancelSheet},model:{value:t.showSheet,callback:function(e){t.showSheet=e},expression:"showSheet"}}),a("van-popup",{staticClass:"commissions",attrs:{round:"",position:"bottom",closeable:""},model:{value:t.showCommissions,callback:function(e){t.showCommissions=e},expression:"showCommissions"}},[a("div",{staticClass:"subtitle-5 pt-4 py-2 text-center"},[t._v(" "+t._s(t.$$t("rebateDetails"))+" ")]),a("div",{staticClass:"background-white py-2 text-grey_1 px-2"},[a("van-row",{attrs:{type:"flex",justify:"space-between"}},[a("van-col",{staticClass:"van-ellipsis",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("gamePlatformName")))])]),a("van-col",{staticClass:"van-ellipsis",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("lvRebate"))+"(%)")])]),a("van-col",{staticClass:"van-ellipsis",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$$t("lowerRebate"))+"(%)")])])],1)],1),a("div",{staticClass:"commissions-warps"},[a("scroll-view",t._l(t.commissions,(function(e,s){return a("van-row",{key:s,staticClass:"background-white py-2 hairline_bottom",attrs:{type:"flex",justify:"space-between"}},[a("van-col",{attrs:{span:"8"}},[a("span",{staticClass:"body-2"},[t._v(t._s(e.gamePlatformName))])]),a("van-col",{attrs:{span:"8"}},[a("span",{staticClass:"body-2"},[t._v(t._s(e.rebate))])]),a("van-col",{attrs:{span:"8"}},[a("span",{staticClass:"body-2"},[t._v("0-"+t._s(e.maxRebate))])])],1)})),1)],1)]),a("van-dialog",{attrs:{title:t.$$t("remarks"),"show-cancel-button":"",confirmButtonColor:"rgb(117, 162, 255)"},on:{confirm:t.onSaveRemark},model:{value:t.showRemark,callback:function(e){t.showRemark=e},expression:"showRemark"}},[a("div",{staticClass:"text-left remark px-4 pb-2 mt-3"},[a("van-field",{attrs:{clearable:"",maxlength:"10",placeholder:t.$$t("inputRemark"),"show-word-limit":""},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)])],1)}),[],!1,null,"274ae57d",null);e.default=i.exports}}]);