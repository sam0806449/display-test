(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-18c7fc23"],{"00ca":function(t,e,s){"use strict";s.r(e);s("4de4"),s("a434"),s("b0c0");var a=s("2909"),n={name:"Task",activated:function(){this.onLoadTaskCategory(),this.onRefresh()},data:function(){return{order:"0",dropdownTitle:this.$$t("type"),refresh:!1,lists:[],categorys:[],categoryCode:"",pageIndex:1}},computed:{getOrders:function(){return[{text:this.$$t("defaultSort"),value:"0"},{text:this.$$t("latestSort"),value:"1"},{text:this.$$t("highestCommission"),value:"2"}]}},watch:{order:function(){this.onRefresh()}},methods:{onLoadData:function(t){var e=this;this.$post("/api/Task/GetTaskPaged",{pageIndex:this.pageIndex,pageSize:10,categoryCode:this.categoryCode,orderBy:this.order}).then((function(t){return e.checkResp(t,(function(t){return!0===t.data.success}))})).then((function(s){var n,o=s.data;(e.pageIndex=e.pageIndex+1,e.refresh)?(e.lists=[],e.lists=o.items,e.refresh=!1,setTimeout((function(){t&&t()}),1e3)):o.items.length>0?((n=e.lists).push.apply(n,Object(a.a)(o.items)),setTimeout((function(){t&&t(!1)}),1e3)):setTimeout((function(){t&&t(!0)}),1e3)})).catch((function(s){t&&t(!0),e.procError(s)}))},onLoadTaskCategory:function(){var t=this;this.$post("/api/Task/GetTaskCategory?isHome=false").then((function(e){return t.checkResp(e,(function(t){return!0===t.data.success}))})).then((function(e){var s=e.data;s.splice(0,0,{code:"",name:t.$t("common.all")}),t.dropdownTitle=s.filter((function(e){return e.code===t.categoryCode}))[0].name,t.categorys=s})).catch((function(e){t.procError(e)}))},applyTask:function(t){var e=this,s=t.objId,a=null;t.isApply?this.$error(this.$$t("received")):(this.showProgress(),this.$post("/api/Task/ApplyTask?objId="+s).then((function(t){return e.checkResp(t,(function(t){return!0===t.data.success}))})).then((function(t){return a=t.data,e.$post("/api/Task/GetTask?objId="+s)})).then((function(t){e.showProgress(!1);var s=t.data.data;s.category_task_applyId=a,s.status=0,s.renounceStatus=1,s.statusDesc=e.$$t("unfinished"),e.$sessionSet("Note-data",s),e.$router.push("notes/details"),e.$success(e.$$t("receiveDesc"))})).catch((function(t){e.showProgress(!1),e.procError(t)})))},typeClick:function(t){this.dropdownTitle=t.name,this.categoryCode=t.code,this.onRefresh(),this.$refs.type.toggle()},goTaskDetails:function(t){var e=this;this.$post("/api/Task/GetTask?objId="+t.objId).then((function(t){return e.checkResp(t,(function(t){return!0===t.data.success}))})).then((function(s){e.$sessionSet("Task-Data",s.data),e.$router.push({path:"/task/details",query:{task_objId:t.objId}})})).catch((function(t){e.procError(t)}))},onRefresh:function(t){this.refresh=!0,this.pageIndex=1,this.onLoadData(t)},$$t:function(t){return this.$t("task."+t)}}},o=(s("3325"),s("2877")),i=Object(o.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"task"}},[s("van-dropdown-menu",{attrs:{"active-color":"rgb(70 132 255)"}},[s("van-dropdown-item",{ref:"type",attrs:{title:t.dropdownTitle}},[s("div",{staticClass:"dropdown-warp"},[s("div",{staticClass:"btns"},t._l(t.categorys,(function(e,a){return s("div",{key:a,staticClass:"btn van-ellipsis",class:{active:t.categoryCode===e.code},on:{click:function(s){return t.typeClick(e)}}},[s("span",[t._v(t._s(e.name))])])})),0)])]),s("van-dropdown-item",{attrs:{options:t.getOrders},model:{value:t.order,callback:function(e){t.order=e},expression:"order"}})],1),s("div",{staticClass:"task-content"},[s("scroll-view",{attrs:{onRefresh:t.onRefresh,loadMore:t.onLoadData}},[t.lists.length>0?s("div",[t._l(t.lists,(function(e,a){return[s("div",{key:a,staticClass:"task-list",on:{click:function(s){return s.stopPropagation(),t.goTaskDetails(e)}}},[s("div",{staticClass:"left"},[s("van-image",{attrs:{width:"46",height:"46","lazy-load":"",src:t.$portrait(e.categoryIco)}},[s("template",{slot:"loading"},[s("van-loading",{attrs:{type:"spinner",size:"20"}})],1)],2)],1),s("div",{staticClass:"right"},[s("van-row",{attrs:{type:"flex",justify:"space-between",gutter:"4"}},[s("van-col",{attrs:{span:"12"}},[s("div",{staticClass:"title van-ellipsis"},[t._v(t._s(e.title))]),s("div",{staticClass:"desc"},[t._v(t._s(t.$$t("surplus"))+"ï¼š"+t._s(Number(e.maxNum)-Number(e.applyNum))+"/"+t._s(Number(e.maxNum))+" ")]),s("div",{staticClass:"center"},[s("van-tag",{attrs:{color:"#FBD079",size:"medium"}},[t._v(t._s(e.categoryName))])],1)]),s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"right-r text-center"},[s("div",{staticClass:"number"},[t._v(t._s(t.currencySymbol)+t._s(e.price)+t._s(t.currencyDenomination)+" ")]),s("div",{staticClass:"btn",on:{click:function(s){return s.stopPropagation(),t.applyTask(e)}}},[t._v(t._s(e.isApply?t.$$t("received"):t.$$t("receive"))+" ")])])])],1)],1)]),a<t.lists.length-1?s("div",{key:a+"_t",staticClass:"van-hairline--bottom",staticStyle:{margin:"0 16px"}}):t._e()]}))],2):s("van-empty",{staticClass:"text-center",attrs:{description:t.$t("common.noMore")},scopedSlots:t._u([{key:"image",fn:function(){return[s("van-image",{attrs:{src:"/images/empty/no-more.png",width:"280",height:"130"}})]},proxy:!0}])})],1)],1)],1)}),[],!1,null,"7fc5c726",null);e.default=i.exports},3325:function(t,e,s){"use strict";s("d36b")},d36b:function(t,e,s){}}]);